let game={maxXY:500,canDraw:!1,valid:!1,lineWidth:5,oob:[0,1,2,3,6,7,8,9,10,11,18,19,20,29,30,39,60,69,70,79,80,81,88,89,90,91,92,93,96,97,98,99],offset:{"03":[20,0],"06":[20,0],30:[0,20],60:[0,20],"04":[15,0],"05":[15,0],40:[15,0],50:[15,0],93:[-20,0],96:[-20,0],39:[0,-20],69:[0,-20],49:[0,-15],59:[0,-15],94:[-15,0],95:[-15,0]},colors:["ff0000","00ff00","0000ff","ffff00"],levels:[[["2187","7166","2382"],["2187","0566","0328"],["1259","5278","6057"],["2460","0657","1274"],["1269","2687","2157"],["4036","3378","1274"],["2193","2460","4057"],["2124","2872","0547"]],[["0454","4078","2135","2876"],["2125","0647","2873","6075"],["2146","1764","2594","3378"],["1244","2833","4294","4660"],["3073","0565","3693","3459"],["0334","2659","4296","6671"],["2176","0432","4694","2359"],["1734","1369","5295","6671"]],[["3056","0537","3593","2852"],["0575","4249","2595","4047"],["4387","1256","3693","1763"],["0474","1776","5471","8226"]]],paths:[],levelCompleted:[],currentLevel:"00",currentTarget:"null"};!function(o){let l=o("#game_menu"),g=o("#game_wrapper"),e=o("#game"),n=o("#pad"),s=o("#settings"),r=e[0].getContext("2d"),m=n[0].getContext("2d"),h=o("#check")[0].getContext("2d"),p=0,f=0,u=[];const t=()=>{var e=JSON.parse(localStorage.getItem("twodots"));e&&(game.levelCompleted=e.levelCompleted||[])},v=()=>{game.paths=[],r.clearRect(0,0,n[0].width,n[0].height),m.strokeStyle=r.strokeStyle="#000",k(),g.find(".node").remove(),[a,b]=game.currentLevel.split("");let e=game.levels[a][b];for(i in e)[a,b,c,d]=e[i].toString().split(""),w(a,b,c,d,i),w(c,d,a,b,i)},w=(e,t,a,o,l)=>{var n=game.maxXY/10,i=.8*n,d=n/2,s=game.offset[e+""+t];let r=t*n+d,m=e*n+d;s&&(m+=s[0],r+=s[1],console.log(game.offset[e+""+t])),g.append('<i class="node '+e+"-"+t+'" style="background-color: #'+game.colors[l]+";width: "+i+"px;height: "+i+"px;top:"+r+"px;left:"+m+'px;" data-color="'+game.colors[l]+'" data-target="'+a+"-"+o+'"data-done="0"></i>')},k=()=>{const e=new Path2D;r.lineWidth=5,e.arc(game.maxXY/2,game.maxXY/2,game.maxXY/2-30,0,2*Math.PI),r.stroke(e),game.paths.push(e)},x=()=>{const e=new Path2D;for(i in r.lineWidth=game.lineWidth,u){var t=u[i].split(",");0<i&&e.lineTo(t[0],t[1]),e.moveTo(t[0],t[1])}r.stroke(e),game.paths.push(e),u=[]};var C=e=>{if(game.canDraw){if(game.canDraw=!1,m.clearRect(0,0,n[0].width,n[0].height),!game.valid)return u=[];(()=>{let a=!0,e=new Path2D,o=game.lineWidth;for(i in h.strokeStyle="rgba(0,0,0,0.2)",h.fillStyle="white",h.fillRect(0,0,n[0].width,n[0].height),game.paths)0<i&&(h.lineWidth=game.lineWidth,h.stroke(game.paths[i]));for(i in u){var t=u[i].split(",");0<i&&e.lineTo(t[0],t[1]),e.moveTo(t[0],t[1])}h.stroke(e),h.lineWidth=5,h.stroke(game.paths[0]);let l;for(let t=1;t<=game.maxXY;t+=o){for(let e=1;e<=game.maxXY&&(l=h.getImageData(t,e,1,1).data,(0<l[0]||0<l[1]||0<l[2])&&(l[0]<200||l[1]<200||l[2]<200)&&(a=!1),a);e+=o);if(!a)break}return h.strokeStyle="rgba(0,0,0,0.2)",a?(x(),!0):(alert("invalid move!"),!(u=[]))})()&&(o(e).data("done",1),o("."+o(e).data("target")).data("done",1),y()),game.valid=!1}};const y=()=>{let e=!0;var t;g.find(".node").each(function(){0===o(this).data("done")&&(e=!1)}),e&&(game.levelCompleted.includes(game.currentLevel)||game.levelCompleted.push(game.currentLevel),t={levelCompleted:game.levelCompleted},localStorage.setItem("twodots",JSON.stringify(t)),alert("Well done!"),l.removeClass("d-none"),g.addClass("d-none"),s.addClass("d-none"),T(game.currentLevel.substring(0,1)))},T=t=>{var a=["BEGINNER","INTERMEDIATE","EXPERT"];if(l.html(""),1===t.length){o('<button data-level="main">Back</button>').appendTo(l);for(let e=0;e<game.levels[t].length&&(o('<button data-level="'+t+e+'">'+a[t]+" - "+(e+1)+"</button>").appendTo(l),game.levelCompleted.includes(t+""+e));e++);}else if(2===t.length)game.currentLevel=t,l.addClass("d-none"),g.removeClass("d-none"),s.removeClass("d-none"),v();else for(let e=0;e<game.levels.length;e++)o('<button data-level="'+e+'">'+a[e]+"</button>").appendTo(l)};l.on("click","button",function(e){T(o(this).data("level").toString())}),s.on("click","#go_main",function(e){l.removeClass("d-none"),g.addClass("d-none"),s.addClass("d-none"),T("main")}).on("click","#reset",function(e){v()}),n.on("mousemove",e=>{var t;game.canDraw&&(t=e.offsetX,e=e.offsetY,m.beginPath(),m.moveTo(p,f),m.lineTo(t,e),m.stroke(),p=t,f=e,u.push(p+","+f))}).on("mouseup",C),g.on("mousedown",".node",function(e){e.preventDefault(),1!==o(this).data("done")&&(p=o(this).css("left").replace("px",""),f=o(this).css("top").replace("px",""),game.currentTarget=o(this).data("target"),m.strokeStyle=r.strokeStyle="#"+o(this).data("color"),game.canDraw=!0,u.push(p+","+f))}).on("mouseenter",".node",function(e){o(this).hasClass(game.currentTarget)&&(game.valid=!0),C(o(this))}),o(window).width()<game.maxXY&&(game.maxXY=o(window).width()),g.css({width:game.maxXY+"px",height:game.maxXY+"px"}),m.canvas.height=r.canvas.height=h.canvas.height=game.maxXY,m.canvas.width=r.canvas.width=h.canvas.width=game.maxXY,m.lineCap=r.lineCap=h.lineCap="round",m.lineWidth=r.lineWidth=h.lineWidth=game.lineWidth,t(),v()}(jQuery);var global={konami:function(){console.log("test");var a=[38,38,40,40,37,39,37,39,66,65],o=!1,l=0;$(document).keydown(function(e){function t(){o=!1,l=0}key=e.keyCode,o||38==key&&(o=!0),o?(a[l]==key?l++:t(),10==l&&($('<iframe src="https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" style="position: fixed; width:100%; height: 100%;z-index: 9999999; top: 0; left: 0;;"></iframe>').appendTo("body"),t())):t()})}};global.konami();